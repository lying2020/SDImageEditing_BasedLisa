# å¯¼å…¥é”™è¯¯ä¿®å¤è¯´æ˜

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1ï¼š`StableDiffusionBrushNetPipeline` å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ImportError: cannot import name 'StableDiffusionBrushNetPipeline' from 'diffusers'
```

**åŸå› **ï¼š
- `StableDiffusionBrushNetPipeline` ä¸åœ¨æ ‡å‡†çš„ diffusers åŒ…ä¸­
- å®ƒåœ¨é¡¹ç›®çš„ `src/diffusers` ç›®å½•ä¸‹ï¼ˆè¿™æ˜¯ä¿®æ”¹åçš„ diffusers ç‰ˆæœ¬ï¼‰

**ä¿®å¤æ–¹æ³•**ï¼š
åœ¨è„šæœ¬å¼€å¤´æ·»åŠ  `src` ç›®å½•åˆ° Python è·¯å¾„ï¼š

```python
# æ·»åŠ é¡¹ç›®è·¯å¾„
project_root = os.path.dirname(os.path.abspath(__file__))
sys.path.insert(0, project_root)
# æ·»åŠ  src ç›®å½•åˆ°è·¯å¾„ï¼ˆåŒ…å«ä¿®æ”¹åçš„ diffusersï¼‰
src_path = os.path.join(project_root, "src")
if src_path not in sys.path:
    sys.path.insert(0, src_path)
```

### é—®é¢˜2ï¼š`cached_download` å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ImportError: cannot import name 'cached_download' from 'huggingface_hub'
```

**åŸå› **ï¼š
- æ–°ç‰ˆæœ¬çš„ `huggingface_hub` (>=0.20.0) ç§»é™¤äº† `cached_download` å‡½æ•°
- é¡¹ç›®ä»£ç ä½¿ç”¨äº†æ—§ç‰ˆæœ¬çš„ API

**ä¿®å¤æ–¹æ³•**ï¼š
åœ¨ `src/diffusers/utils/dynamic_modules_utils.py` ä¸­æ·»åŠ å…¼å®¹æ€§å¤„ç†ï¼š

```python
try:
    from huggingface_hub import cached_download, hf_hub_download, model_info
except ImportError:
    # æ–°ç‰ˆæœ¬çš„ huggingface_hub ç§»é™¤äº† cached_downloadï¼Œä½¿ç”¨ hf_hub_download æ›¿ä»£
    from huggingface_hub import hf_hub_download, model_info
    cached_download = hf_hub_download  # å…¼å®¹æ€§å¤„ç†
```

## âœ… å·²ä¿®å¤çš„æ–‡ä»¶

1. **`test_009_example.py`** - æ·»åŠ äº† `src` ç›®å½•åˆ° Python è·¯å¾„
2. **`test_demo_batch.py`** - æ·»åŠ äº† `src` ç›®å½•åˆ° Python è·¯å¾„
3. **`src/diffusers/utils/dynamic_modules_utils.py`** - ä¿®å¤äº† `cached_download` å…¼å®¹æ€§é—®é¢˜

## ğŸ“ ä½¿ç”¨è¯´æ˜

### æ–¹å¼1ï¼šä½¿ç”¨ä¿®å¤åçš„è„šæœ¬ï¼ˆæ¨èï¼‰

ç›´æ¥è¿è¡Œä¿®å¤åçš„è„šæœ¬ï¼š

```bash
cd /home/liying/Desktop/IMAGE_EDITE-CVPR-2025/SDImageEditing_SmartFreeEdit
python3 test_009_example.py
```

### æ–¹å¼2ï¼šè®¾ç½®ç¯å¢ƒå˜é‡

ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½® PYTHONPATHï¼š

```bash
export PYTHONPATH=/home/liying/Desktop/IMAGE_EDITE-CVPR-2025/SDImageEditing_SmartFreeEdit/src:$PYTHONPATH
python3 test_009_example.py
```

### æ–¹å¼3ï¼šä½¿ç”¨é¡¹ç›®çš„å®‰è£…æ–¹å¼

å¦‚æœé¡¹ç›®å·²å®‰è£…ï¼ˆ`pip install -e .`ï¼‰ï¼Œåˆ™ä¸éœ€è¦æ‰‹åŠ¨æ·»åŠ è·¯å¾„ï¼š

```bash
cd /home/liying/Desktop/IMAGE_EDITE-CVPR-2025/SDImageEditing_SmartFreeEdit
pip install -e .
python3 test_009_example.py
```

## âš ï¸ å…¶ä»–å¯èƒ½çš„é—®é¢˜

### ç¼ºå°‘ä¾èµ–æ¨¡å—

å¦‚æœé‡åˆ°ç±»ä¼¼é”™è¯¯ï¼š
```
ModuleNotFoundError: No module named 'segment_anything'
```

éœ€è¦å®‰è£…ç¼ºå¤±çš„ä¾èµ–ï¼š

```bash
pip install segment-anything
```

æˆ–è€…å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š

```bash
pip install -r requirements.txt
```

### éªŒè¯ä¿®å¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯å¯¼å…¥æ˜¯å¦æˆåŠŸï¼š

```bash
cd /home/liying/Desktop/IMAGE_EDITE-CVPR-2025/SDImageEditing_SmartFreeEdit
python3 -c "
import sys
import os
project_root = os.getcwd()
src_path = os.path.join(project_root, 'src')
sys.path.insert(0, src_path)
from diffusers import StableDiffusionBrushNetPipeline
print('âœ… å¯¼å…¥æˆåŠŸï¼')
"
```

åº”è¯¥è¾“å‡ºï¼š`âœ… å¯¼å…¥æˆåŠŸï¼`

## ğŸ“‹ æ€»ç»“

- âœ… **å¯¼å…¥é”™è¯¯å·²ä¿®å¤**ï¼šæ·»åŠ äº† `src` ç›®å½•åˆ° Python è·¯å¾„
- âœ… **å…¼å®¹æ€§é—®é¢˜å·²ä¿®å¤**ï¼šå¤„ç†äº†æ–°ç‰ˆæœ¬ `huggingface_hub` çš„ API å˜åŒ–
- âœ… **è„šæœ¬å·²æ›´æ–°**ï¼š`test_009_example.py` å’Œ `test_demo_batch.py` éƒ½å·²ä¿®å¤

ç°åœ¨å¯ä»¥æ­£å¸¸è¿è¡Œè„šæœ¬äº†ï¼

---

**æœ€åæ›´æ–°**ï¼š2025å¹´
